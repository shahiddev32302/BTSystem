@{
    ViewData["Title"] = "Trip Scheduling";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    /* Trip Card Styles */
    .trip-card {
        background: var(--bg);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 20px;
        transition: all 0.3s ease;
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        height: 100%;
    }

        .trip-card:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transform: translateY(-3px);
            border-color: var(--primary);
        }

    .trip-icon {
        width: 50px;
        height: 50px;
        border-radius: 10px;
        background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 20px;
        margin-bottom: 15px;
    }

    .trip-time-badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background: rgba(30, 58, 138, 0.1);
        color: var(--primary);
        border-radius: 8px;
        font-size: 14px;
        font-weight: 600;
        margin-bottom: 10px;
    }

    .trip-status {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        text-transform: uppercase;
    }

    .status-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
    }

    .status-scheduled {
        background: rgba(59, 130, 246, 0.15);
        color: var(--primary-light);
    }

        .status-scheduled .status-dot {
            background: var(--primary-light);
        }

    .status-in-progress {
        background: rgba(250, 204, 21, 0.15);
        color: #ca8a04;
    }

        .status-in-progress .status-dot {
            background: #ca8a04;
        }

    .status-completed {
        background: rgba(34, 197, 94, 0.15);
        color: #16a34a;
    }

        .status-completed .status-dot {
            background: #16a34a;
        }

    .status-cancelled {
        background: rgba(239, 68, 68, 0.15);
        color: #dc2626;
    }

        .status-cancelled .status-dot {
            background: #dc2626;
        }

    .trip-info-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 12px;
        margin: 15px 0;
    }

    .trip-info-item {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 14px;
        color: var(--text-secondary);
    }

        .trip-info-item i {
            color: var(--primary);
            width: 16px;
            text-align: center;
        }

    .filter-tabs {
        display: flex;
        gap: 10px;
        margin-bottom: 25px;
        padding: 15px;
        background: var(--bg);
        border-radius: 12px;
        border: 1px solid var(--border);
    }

    .filter-tab {
        padding: 8px 20px;
        border: none;
        background: transparent;
        border-radius: 8px;
        color: var(--text-secondary);
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
    }

        .filter-tab:hover {
            background: var(--gray-100);
        }

        .filter-tab.active {
            background: var(--primary);
            color: white;
        }

    .calendar-sidebar {
        background: var(--bg);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 25px;
    }

    .calendar-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }

    .calendar-nav {
        display: flex;
        gap: 10px;
    }

    .calendar-weekdays {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 5px;
        margin-bottom: 10px;
        text-align: center;
        font-size: 12px;
        color: var(--text-secondary);
    }

    .calendar-days {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 5px;
    }

    .calendar-day {
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 14px;
    }

        .calendar-day:hover {
            background: var(--gray-100);
        }

        .calendar-day.active {
            background: var(--primary);
            color: white;
        }

        .calendar-day.has-trips {
            position: relative;
        }

            .calendar-day.has-trips::after {
                content: '';
                position: absolute;
                bottom: 4px;
                left: 50%;
                transform: translateX(-50%);
                width: 4px;
                height: 4px;
                border-radius: 50%;
                background: var(--primary);
            }

    .card-actions {
        display: flex;
        gap: 10px;
        margin-top: 15px;
    }

        .card-actions .btn {
            flex: 1;
            padding: 8px;
            font-size: 14px;
        }

    /* Timeline View */
    .timeline-view {
        background: var(--bg);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 20px;
    }

    .timeline-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }

    .timeline-item {
        display: flex;
        align-items: flex-start;
        gap: 15px;
        padding: 15px;
        border-bottom: 1px solid var(--border);
        transition: all 0.3s ease;
    }

        .timeline-item:hover {
            background: var(--bg-secondary);
        }

        .timeline-item:last-child {
            border-bottom: none;
        }

    .timeline-time {
        min-width: 80px;
        text-align: center;
        padding: 8px 12px;
        background: var(--bg-secondary);
        border-radius: 8px;
        font-weight: 600;
        color: var(--text-primary);
    }

    .timeline-content {
        flex: 1;
    }

    .timeline-actions {
        display: flex;
        gap: 8px;
    }
</style>

<!-- Content Area -->
<div class="content-area" id="contentArea">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="mb-2">Trip Scheduling</h2>
            <p class="text-muted">Schedule and manage bus trips</p>
        </div>
        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addTripModal">
            <i class="fas fa-plus me-2"></i>Schedule Trip
        </button>
    </div>

    <!-- Status Filter Tabs -->
    <div class="filter-tabs">
        <button class="filter-tab active" data-status="all">All Trips</button>
        <button class="filter-tab" data-status="scheduled">Scheduled</button>
        <button class="filter-tab" data-status="in-progress">In Progress</button>
        <button class="filter-tab" data-status="completed">Completed</button>
        <button class="filter-tab" data-status="cancelled">Cancelled</button>
    </div>

    <div class="row">
        <!-- Calendar Sidebar -->
        <div class="col-lg-4 mb-4">
            <div class="calendar-sidebar">
                <div class="calendar-header">
                    <h5 class="mb-0">December 2024</h5>
                    <div class="calendar-nav">
                        <button class="btn btn-sm btn-outline-primary">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-primary">Today</button>
                        <button class="btn btn-sm btn-outline-primary">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>

                <div class="calendar-weekdays">
                    <div>Sun</div>
                    <div>Mon</div>
                    <div>Tue</div>
                    <div>Wed</div>
                    <div>Thu</div>
                    <div>Fri</div>
                    <div>Sat</div>
                </div>

                <div class="calendar-days">
                    <!-- December 2024 calendar -->
                    <div class="calendar-day"></div>
                    <div class="calendar-day"></div>
                    <div class="calendar-day"></div>
                    <div class="calendar-day">1</div>
                    <div class="calendar-day">2</div>
                    <div class="calendar-day">3</div>
                    <div class="calendar-day">4</div>
                    <div class="calendar-day">5</div>
                    <div class="calendar-day has-trips active">6</div>
                    <div class="calendar-day has-trips">7</div>
                    <div class="calendar-day">8</div>
                    <div class="calendar-day has-trips">9</div>
                    <div class="calendar-day">10</div>
                    <div class="calendar-day">11</div>
                    <div class="calendar-day has-trips">12</div>
                    <div class="calendar-day">13</div>
                    <div class="calendar-day">14</div>
                    <div class="calendar-day">15</div>
                    <div class="calendar-day has-trips">16</div>
                    <div class="calendar-day">17</div>
                    <div class="calendar-day">18</div>
                    <div class="calendar-day has-trips">19</div>
                    <div class="calendar-day">20</div>
                    <div class="calendar-day">21</div>
                    <div class="calendar-day has-trips">22</div>
                    <div class="calendar-day">23</div>
                    <div class="calendar-day">24</div>
                    <div class="calendar-day">25</div>
                    <div class="calendar-day">26</div>
                    <div class="calendar-day has-trips">27</div>
                    <div class="calendar-day">28</div>
                    <div class="calendar-day">29</div>
                    <div class="calendar-day has-trips">30</div>
                    <div class="calendar-day">31</div>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="card mb-4">
                <div class="card-body">
                    <h6 class="card-title mb-3">Today's Overview</h6>
                    <div class="d-flex justify-content-between mb-2">
                        <span>Scheduled:</span>
                        <strong>8 trips</strong>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span>In Progress:</span>
                        <strong>3 trips</strong>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span>Completed:</span>
                        <strong>12 trips</strong>
                    </div>
                    <div class="d-flex justify-content-between">
                        <span>Cancelled:</span>
                        <strong>1 trip</strong>
                    </div>
                </div>
            </div>
        </div>

        <!-- Trips Grid -->
        <div class="col-lg-8">
            <div class="timeline-view">
                <div class="timeline-header">
                    <h5 class="mb-0">Today's Trips (Dec 6, 2024)</h5>
                    <div class="d-flex gap-2">
                        <button class="btn btn-sm btn-outline-primary">
                            <i class="fas fa-list"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-primary active">
                            <i class="fas fa-calendar-day"></i>
                        </button>
                    </div>
                </div>

                <!-- Timeline Items -->
                <div class="timeline-item">
                    <div class="timeline-time">06:30 AM</div>
                    <div class="timeline-content">
                        <h6 class="mb-1">Route 1 - Campus Loop</h6>
                        <p class="text-muted small mb-1">
                            <i class="fas fa-bus me-1"></i>BUS-101 |
                            <i class="fas fa-user-tie ms-2 me-1"></i>John Smith |
                            <i class="fas fa-route ms-2 me-1"></i>8.5 km
                        </p>
                        <span class="trip-status status-scheduled">
                            <span class="status-dot"></span>
                            Scheduled
                        </span>
                    </div>
                    <div class="timeline-actions">
                        <button class="btn btn-sm btn-primary">
                            <i class="fas fa-play"></i> Start
                        </button>
                        <button class="btn btn-sm btn-outline-secondary">
                            <i class="fas fa-edit"></i>
                        </button>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-time">07:45 AM</div>
                    <div class="timeline-content">
                        <h6 class="mb-1">Route 2 - Hostel Route</h6>
                        <p class="text-muted small mb-1">
                            <i class="fas fa-bus me-1"></i>BUS-102 |
                            <i class="fas fa-user-tie ms-2 me-1"></i>Maria Garcia |
                            <i class="fas fa-route ms-2 me-1"></i>6.2 km
                        </p>
                        <span class="trip-status status-in-progress">
                            <span class="status-dot"></span>
                            In Progress
                        </span>
                    </div>
                    <div class="timeline-actions">
                        <button class="btn btn-sm btn-warning">
                            <i class="fas fa-pause"></i> Pause
                        </button>
                        <button class="btn btn-sm btn-outline-secondary">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-time">09:00 AM</div>
                    <div class="timeline-content">
                        <h6 class="mb-1">Route 3 - City Express</h6>
                        <p class="text-muted small mb-1">
                            <i class="fas fa-bus me-1"></i>BUS-103 |
                            <i class="fas fa-user-tie ms-2 me-1"></i>Ahmed Hassan |
                            <i class="fas fa-route ms-2 me-1"></i>12.5 km
                        </p>
                        <span class="trip-status status-scheduled">
                            <span class="status-dot"></span>
                            Scheduled
                        </span>
                    </div>
                    <div class="timeline-actions">
                        <button class="btn btn-sm btn-primary">
                            <i class="fas fa-play"></i> Start
                        </button>
                        <button class="btn btn-sm btn-outline-secondary">
                            <i class="fas fa-edit"></i>
                        </button>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-time">10:30 AM</div>
                    <div class="timeline-content">
                        <h6 class="mb-1">Route 4 - Hospital Run</h6>
                        <p class="text-muted small mb-1">
                            <i class="fas fa-bus me-1"></i>BUS-104 |
                            <i class="fas fa-user-tie ms-2 me-1"></i>Sarah Johnson |
                            <i class="fas fa-route ms-2 me-1"></i>5.8 km
                        </p>
                        <span class="trip-status status-completed">
                            <span class="status-dot"></span>
                            Completed
                        </span>
                    </div>
                    <div class="timeline-actions">
                        <button class="btn btn-sm btn-outline-success">
                            <i class="fas fa-file-alt"></i> Report
                        </button>
                        <button class="btn btn-sm btn-outline-secondary">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-time">02:00 PM</div>
                    <div class="timeline-content">
                        <h6 class="mb-1">Route 1 - Campus Loop</h6>
                        <p class="text-muted small mb-1">
                            <i class="fas fa-bus me-1"></i>BUS-101 |
                            <i class="fas fa-user-tie ms-2 me-1"></i>Robert Kim |
                            <i class="fas fa-route ms-2 me-1"></i>8.5 km
                        </p>
                        <span class="trip-status status-scheduled">
                            <span class="status-dot"></span>
                            Scheduled
                        </span>
                    </div>
                    <div class="timeline-actions">
                        <button class="btn btn-sm btn-primary">
                            <i class="fas fa-play"></i> Start
                        </button>
                        <button class="btn btn-sm btn-outline-secondary">
                            <i class="fas fa-edit"></i>
                        </button>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-time">04:30 PM</div>
                    <div class="timeline-content">
                        <h6 class="mb-1">Route 2 - Hostel Route</h6>
                        <p class="text-muted small mb-1">
                            <i class="fas fa-bus me-1"></i>BUS-105 |
                            <i class="fas fa-user-tie ms-2 me-1"></i>John Smith |
                            <i class="fas fa-route ms-2 me-1"></i>6.2 km
                        </p>
                        <span class="trip-status status-cancelled">
                            <span class="status-dot"></span>
                            Cancelled
                        </span>
                    </div>
                    <div class="timeline-actions">
                        <button class="btn btn-sm btn-outline-secondary">
                            <i class="fas fa-redo"></i> Reschedule
                        </button>
                        <button class="btn btn-sm btn-outline-secondary">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="addTripModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5>Schedule New Trip</h5>
                <button class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <select class="form-select mb-2">
                    <option>Select Route</option>
                    <option>Campus Loop</option>
                </select>
                <select class="form-select mb-2">
                    <option>Select Bus</option>
                    <option>BUS-101</option>
                </select>
                <input type="time" class="form-control mb-2">
                <input type="date" class="form-control mb-2">
                <select class="form-select">
                    <option>Select Driver</option>
                    <option>John Smith</option>
                </select>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button class="btn btn-primary">Schedule</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="addTripModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Schedule New Trip</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label class="form-label">Route</label>
                        <select class="form-select">
                            <option selected>Select a route</option>
                            <option>Route 1 - Campus Loop</option>
                            <option>Route 2 - Hostel Route</option>
                            <option>Route 3 - City Express</option>
                            <option>Route 4 - Hospital Run</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Bus</label>
                        <select class="form-select">
                            <option selected>Select a bus</option>
                            <option>BUS-101</option>
                            <option>BUS-102</option>
                            <option>BUS-103</option>
                            <option>BUS-104</option>
                            <option>BUS-105</option>
                        </select>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Departure Time</label>
                            <input type="time" class="form-control">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Date</label>
                            <input type="date" class="form-control" value="2024-12-06">
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Driver</label>
                        <select class="form-select">
                            <option selected>Select a driver</option>
                            <option>John Smith (Senior Driver)</option>
                            <option>Maria Garcia (Senior Driver)</option>
                            <option>Ahmed Hassan (Driver)</option>
                            <option>Sarah Johnson (Senior Driver)</option>
                            <option>Robert Kim (Driver)</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Notes (Optional)</label>
                        <textarea class="form-control" rows="2" placeholder="Additional instructions or notes..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary">Schedule Trip</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Filter tabs functionality
            const filterTabs = document.querySelectorAll('.filter-tab');
            const timelineItems = document.querySelectorAll('.timeline-item');

            filterTabs.forEach(tab => {
                tab.addEventListener('click', function () {
                    filterTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');

                    const status = this.getAttribute('data-status');

                    timelineItems.forEach(item => {
                        if (status === 'all') {
                            item.style.display = 'flex';
                        } else {
                            const itemStatus = item.querySelector('.trip-status').classList.contains(`status-${status}`);
                            item.style.display = itemStatus ? 'flex' : 'none';
                        }
                    });
                });
            });

            // Calendar day selection
            const calendarDays = document.querySelectorAll('.calendar-day:not(:empty)');
            calendarDays.forEach(day => {
                day.addEventListener('click', function () {
                    calendarDays.forEach(d => d.classList.remove('active'));
                    this.classList.add('active');

                    // In real app, this would fetch trips for selected date
                    const dateNum = this.textContent;
                    document.querySelector('.timeline-header h5').textContent = `Today's Trips (Dec ${dateNum}, 2024)`;
                });
            });

            // Search functionality
            const searchInput = document.querySelector('.search-box input');
            searchInput.addEventListener('input', function () {
                const searchTerm = this.value.toLowerCase();

                timelineItems.forEach(item => {
                    const routeName = item.querySelector('h6').textContent.toLowerCase();
                    const busInfo = item.querySelector('p').textContent.toLowerCase();

                    if (routeName.includes(searchTerm) || busInfo.includes(searchTerm)) {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
        });
    </script>
}
