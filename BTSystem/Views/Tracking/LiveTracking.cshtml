@{
    ViewData["Title"] = "Live Tracking";
    Layout = "~/Views/Shared/_Layout.cshtml"; // agar common layout use ho raha ho
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Live Tracking</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="~/css/live-tracking.css" rel="stylesheet" />
 
</head>

<body>

    <div class="content-area" id="contentArea">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h2 class="mb-2">Live Bus Tracking</h2>
                <p class="text-muted">Real-time tracking of all active buses</p>
            </div>
            <div class="d-flex gap-2">
                <button class="btn btn-outline-primary">
                    <i class="fas fa-sync-alt me-2"></i>Refresh
                </button>
                <button class="btn btn-primary">
                    <i class="fas fa-map-marked-alt me-2"></i>Full Screen
                </button>
            </div>
        </div>

        <!-- Filter Tabs -->
        <div class="filter-tabs">
            <button class="filter-tab active" data-filter="all">All Buses</button>
            <button class="filter-tab" data-filter="active">Active</button>
            <button class="filter-tab" data-filter="idle">Idle</button>
            <button class="filter-tab" data-filter="offline">Offline</button>
            <button class="filter-tab" data-filter="routes">By Route</button>
        </div>

        <div class="tracking-container">
            <!-- Left Panel: Bus List -->
            <aside class="tracking-panel left-panel">
                <div class="panel-header">
                    <h3>Active Buses</h3>
                    <span class="badge bg-primary">8</span>
                </div>
                <div class="bus-list">
                    <!-- Bus 1 -->
                    <div class="bus-card active" data-bus-id="101" onclick="selectBus(101)">
                        <div class="bus-header">
                            <span class="bus-badge">
                                <i class="fas fa-bus"></i> BUS-101
                            </span>
                            <span class="bus-status status-live">
                                <span class="status-dot"></span>
                                Live
                            </span>
                        </div>
                        <div class="bus-details-grid">
                            <div class="detail-item">
                                <span class="detail-label">Driver</span>
                                <span class="detail-value">John Smith</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Route</span>
                                <span class="detail-value">Campus Loop</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Speed</span>
                                <span class="detail-value">35 km/h</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Passengers</span>
                                <span class="detail-value">32/52</span>
                            </div>
                        </div>
                    </div>

                    <!-- Bus 2 -->
                    <div class="bus-card" data-bus-id="102" onclick="selectBus(102)">
                        <div class="bus-header">
                            <span class="bus-badge">
                                <i class="fas fa-bus"></i> BUS-102
                            </span>
                            <span class="bus-status status-live">
                                <span class="status-dot"></span>
                                Live
                            </span>
                        </div>
                        <div class="bus-details-grid">
                            <div class="detail-item">
                                <span class="detail-label">Driver</span>
                                <span class="detail-value">Maria Garcia</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Route</span>
                                <span class="detail-value">Hostel Route</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Speed</span>
                                <span class="detail-value">28 km/h</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Passengers</span>
                                <span class="detail-value">28/55</span>
                            </div>
                        </div>
                    </div>

                    <!-- Bus 3 -->
                    <div class="bus-card" data-bus-id="103" onclick="selectBus(103)">
                        <div class="bus-header">
                            <span class="bus-badge">
                                <i class="fas fa-bus"></i> BUS-103
                            </span>
                            <span class="bus-status status-idle">
                                <span class="status-dot"></span>
                                Idle
                            </span>
                        </div>
                        <div class="bus-details-grid">
                            <div class="detail-item">
                                <span class="detail-label">Driver</span>
                                <span class="detail-value">Ahmed Hassan</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Route</span>
                                <span class="detail-value">City Express</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Speed</span>
                                <span class="detail-value">0 km/h</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Passengers</span>
                                <span class="detail-value">0/60</span>
                            </div>
                        </div>
                    </div>

                    <!-- Bus 4 -->
                    <div class="bus-card" data-bus-id="104" onclick="selectBus(104)">
                        <div class="bus-header">
                            <span class="bus-badge">
                                <i class="fas fa-bus"></i> BUS-104
                            </span>
                            <span class="bus-status status-live">
                                <span class="status-dot"></span>
                                Live
                            </span>
                        </div>
                        <div class="bus-details-grid">
                            <div class="detail-item">
                                <span class="detail-label">Driver</span>
                                <span class="detail-value">Sarah Johnson</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Route</span>
                                <span class="detail-value">Hospital Run</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Speed</span>
                                <span class="detail-value">42 km/h</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Passengers</span>
                                <span class="detail-value">45/52</span>
                            </div>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Center Panel: Map -->
            <div class="tracking-panel center-panel">
                <div class="panel-header">
                    <h3>Live Map View</h3>
                    <div class="d-flex gap-2">
                        <button class="btn btn-sm btn-outline-primary">
                            <i class="fas fa-plus"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-primary">
                            <i class="fas fa-minus"></i>
                        </button>
                    </div>
                </div>
                <div class="map-container">
                    <!-- Map Controls -->
                    <div class="map-controls">
                        <button class="map-control-btn" title="Zoom In">
                            <i class="fas fa-plus"></i>
                        </button>
                        <button class="map-control-btn" title="Zoom Out">
                            <i class="fas fa-minus"></i>
                        </button>
                        <button class="map-control-btn" title="Reset View">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="map-control-btn" title="My Location">
                            <i class="fas fa-location-arrow"></i>
                        </button>
                    </div>

                    <!-- SVG Map -->
                    <svg class="tracking-map" viewBox="0 0 800 600">
                        <!-- Campus Routes -->
                        <path class="route-line" d="M 150 100 L 350 100 L 350 300 L 550 300 L 550 500 L 150 500 Z" />
                        <path class="route-line" d="M 200 150 L 500 150 L 500 450" stroke="#f97316" />
                        <path class="route-line" d="M 100 400 L 300 400 L 300 200" stroke="#10b981" />

                        <!-- Bus Stops -->
                        <circle cx="150" cy="100" r="6" class="stop-marker" />
                        <circle cx="350" cy="100" r="6" class="stop-marker" />
                        <circle cx="350" cy="300" r="6" class="stop-marker" />
                        <circle cx="550" cy="300" r="6" class="stop-marker" />
                        <circle cx="550" cy="500" r="6" class="stop-marker" />
                        <circle cx="150" cy="500" r="6" class="stop-marker" />
                        <circle cx="200" cy="150" r="6" class="stop-marker" />
                        <circle cx="500" cy="150" r="6" class="stop-marker" />
                        <circle cx="500" cy="450" r="6" class="stop-marker" />
                        <circle cx="100" cy="400" r="6" class="stop-marker" />
                        <circle cx="300" cy="400" r="6" class="stop-marker" />
                        <circle cx="300" cy="200" r="6" class="stop-marker" />

                        <!-- Bus Markers -->
                        <g class="bus-marker" id="map-bus-101" onclick="selectBus(101)" transform="translate(250, 150)">
                            <rect x="-12" y="-16" width="24" height="32" fill="#1e3a8a" rx="4" />
                            <circle cx="-8" cy="12" r="3" fill="white" />
                            <circle cx="8" cy="12" r="3" fill="white" />
                            <circle cx="0" cy="-16" r="4" class="bus-pulse" />
                            <text x="0" y="0" text-anchor="middle" fill="white" font-size="10" dy=".3em">101</text>
                        </g>

                        <g class="bus-marker" id="map-bus-102" onclick="selectBus(102)" transform="translate(450, 350)">
                            <rect x="-12" y="-16" width="24" height="32" fill="#1e3a8a" rx="4" />
                            <circle cx="-8" cy="12" r="3" fill="white" />
                            <circle cx="8" cy="12" r="3" fill="white" />
                            <circle cx="0" cy="-16" r="4" class="bus-pulse" />
                            <text x="0" y="0" text-anchor="middle" fill="white" font-size="10" dy=".3em">102</text>
                        </g>

                        <g class="bus-marker" id="map-bus-103" onclick="selectBus(103)" transform="translate(500, 150)">
                            <rect x="-12" y="-16" width="24" height="32" fill="#6b7280" rx="4" />
                            <circle cx="-8" cy="12" r="3" fill="white" />
                            <circle cx="8" cy="12" r="3" fill="white" />
                            <circle cx="0" cy="-16" r="4" fill="#9ca3af" />
                            <text x="0" y="0" text-anchor="middle" fill="white" font-size="10" dy=".3em">103</text>
                        </g>

                        <g class="bus-marker" id="map-bus-104" onclick="selectBus(104)" transform="translate(100, 400)">
                            <rect x="-12" y="-16" width="24" height="32" fill="#1e3a8a" rx="4" />
                            <circle cx="-8" cy="12" r="3" fill="white" />
                            <circle cx="8" cy="12" r="3" fill="white" />
                            <circle cx="0" cy="-16" r="4" class="bus-pulse" />
                            <text x="0" y="0" text-anchor="middle" fill="white" font-size="10" dy=".3em">104</text>
                        </g>
                    </svg>
                </div>
            </div>

            <!-- Right Panel: Bus Details -->
            <aside class="tracking-panel right-panel">
                <div class="panel-header">
                    <h3>Bus Details</h3>
                    <span class="badge bg-primary">BUS-101</span>
                </div>
                <div class="bus-info-section">
                    <div class="bus-info-header">
                        <div class="bus-info-icon">
                            <i class="fas fa-bus"></i>
                        </div>
                        <div>
                            <h4 class="mb-0">BUS-101</h4>
                            <p class="text-muted small mb-0">Campus Loop Route</p>
                        </div>
                    </div>

                    <div class="info-grid">
                        <div class="info-item">
                            <span class="label">Driver</span>
                            <span class="value">John Smith</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Status</span>
                            <span class="value">
                                <span class="bus-status status-live">
                                    <span class="status-dot"></span>
                                    Live
                                </span>
                            </span>
                        </div>
                        <div class="info-item">
                            <span class="label">Speed</span>
                            <span class="value">35 km/h</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Next Stop</span>
                            <span class="value">Main Hall</span>
                        </div>
                        <div class="info-item">
                            <span class="label">ETA to Stop</span>
                            <span class="value">5 mins</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Capacity</span>
                            <span class="value">32/52</span>
                        </div>
                    </div>

                    <div class="mb-3">
                        <div class="d-flex justify-content-between mb-1">
                            <span class="small">Capacity Usage</span>
                            <span class="small">61%</span>
                        </div>
                        <div class="capacity-progress">
                            <div class="capacity-fill" style="width: 61%"></div>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-outline-primary">
                            <i class="fas fa-phone-alt me-1"></i>Call Driver
                        </button>
                        <button class="btn btn-outline-primary">
                            <i class="fas fa-map-marker-alt me-1"></i>Track Live
                        </button>
                    </div>
                </div>
            </aside>
        </div>
    </div>
    <script>
        /* ================= FILTER TABS ================= */
        const filterTabs = document.querySelectorAll('.filter-tab');
        const busCards = document.querySelectorAll('.bus-card');

        filterTabs.forEach(tab => {
            tab.addEventListener('click', function () {
                filterTabs.forEach(t => t.classList.remove('active'));
                this.classList.add('active');

                const filter = this.dataset.filter;

                busCards.forEach(card => {
                    if (filter === 'all') {
                        card.style.display = 'block';
                    }
                    else if (filter === 'active') {
                        card.style.display = card.querySelector('.status-live') ? 'block' : 'none';
                    }
                    else if (filter === 'idle') {
                        card.style.display = card.querySelector('.status-idle') ? 'block' : 'none';
                    }
                    else if (filter === 'offline') {
                        card.style.display = card.querySelector('.status-offline') ? 'block' : 'none';
                    }
                });
            });
        });

        /* ================= BUS DATA ================= */
        const busData = {
            101: {
                busId: 'BUS-101',
                driver: 'John Smith',
                route: 'Campus Loop',
                status: 'Live',
                speed: '35 km/h',
                nextStop: 'Main Hall',
                eta: '5 mins',
                capacity: '32/52',
                capacityPercent: 61
            },
            102: {
                busId: 'BUS-102',
                driver: 'Maria Garcia',
                route: 'Hostel Route',
                status: 'Live',
                speed: '28 km/h',
                nextStop: 'Hostel Block A',
                eta: '3 mins',
                capacity: '28/55',
                capacityPercent: 51
            },
            103: {
                busId: 'BUS-103',
                driver: 'Ahmed Hassan',
                route: 'City Express',
                status: 'Idle',
                speed: '0 km/h',
                nextStop: 'City Center',
                eta: '--',
                capacity: '0/60',
                capacityPercent: 0
            },
            104: {
                busId: 'BUS-104',
                driver: 'Sarah Johnson',
                route: 'Hospital Run',
                status: 'Live',
                speed: '42 km/h',
                nextStop: 'City Hospital',
                eta: '8 mins',
                capacity: '45/52',
                capacityPercent: 87
            }
        };

        /* ================= SELECT BUS ================= */
        function selectBus(busId) {
            document.querySelectorAll('.bus-card').forEach(c => c.classList.remove('active'));
            const card = document.querySelector(`.bus-card[data-bus-id="${busId}"]`);
            if (card) card.classList.add('active');

            updateBusDetails(busId);
            highlightBusOnMap(busId);
        }

        /* ================= UPDATE DETAILS ================= */
        function updateBusDetails(busId) {
            const bus = busData[busId];
            if (!bus) return;

            document.querySelector('.right-panel .badge').textContent = bus.busId;
            document.querySelector('.bus-info-header h4').textContent = bus.busId;
            document.querySelector('.bus-info-header .text-muted').textContent = bus.route + ' Route';

            const items = document.querySelectorAll('.info-grid .info-item .value');
            items[0].textContent = bus.driver;
            items[2].textContent = bus.speed;
            items[3].textContent = bus.nextStop;
            items[4].textContent = bus.eta;
            items[5].textContent = bus.capacity;

            items[1].innerHTML = `
                <span class="bus-status status-${bus.status.toLowerCase()}">
                    <span class="status-dot"></span>${bus.status}
                </span>
            `;

            document.querySelector('.capacity-fill').style.width = bus.capacityPercent + '%';
        }

        /* ================= MAP HIGHLIGHT ================= */
        function highlightBusOnMap(busId) {
            document.querySelectorAll('.bus-marker').forEach(m => {
                m.style.opacity = '0.6';
                m.querySelector('rect').setAttribute('fill', '#1e3a8a');
            });

            const activeBus = document.getElementById('map-bus-' + busId);
            if (activeBus) {
                activeBus.style.opacity = '1';
                activeBus.querySelector('rect').setAttribute('fill', '#f97316');
            }
        }

        /* ================= INITIAL LOAD ================= */
        selectBus(101);
    </script>

</body>
</html>
